/**
 * Возвращает методы для запуска модуля системы с потдержкой логирования на основе log4js.
 * Переопределяет объект console.
 */
var config = require('refurbish-notifier-config').logger;
var log4js = require('log4js');
var path = require('path');
var fs = require('fs');

// Подготавливаем путь к файлу логгера
if (!config.logpath) {
	throw Error('No log path');
}
var logpath = path.normalize(path.resolve(__dirname + '/../../' + config.logpath));

// console.log(logpath)

// Проверяем на сущестование папки
try {
	if (!fs.lstatSync(logpath).isDirectory()) {
		fs.mkdirSync(logpath);
	}
} catch(e) {
	fs.mkdirSync(logpath);
}

// Настраиваем логгер
log4js.configure({
	appenders: [/*{
		type: 'dateFile',
		filename: logpath + '/log',
		pattern: "-yyyy-MM-dd.log",
		alwaysIncludePattern: true,
		category: 'refurbish-notifier'
	},*/ {
		type: 'console'
	}]
});

function Logger(label) {
	return log4js.getLogger(label);
}

module.exports = Logger;


